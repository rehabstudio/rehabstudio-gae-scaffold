machine:
  services:
    - docker

dependencies:
  override:
    - docker build -t="gae_scaffold" .

test:
  override:
    - docker run -t -i -v "`pwd`/src/server:/src" -v "`pwd`/build:/home/aeuser/build" -u 0 gae_scaffold make -C /src test
  post:
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/;
    - cp ./build/tests.xml $CIRCLE_TEST_REPORTS/junit/;
    - mkdir -p $CIRCLE_ARTIFACTS/python/;
    - cp ./build/coverage.xml $CIRCLE_ARTIFACTS/python/;
